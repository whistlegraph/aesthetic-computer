<!DOCTYPE html>
<html>
<head>
  <title>Give ¬∑ Aesthetic Computer</title>
  <meta name="description" content="Support Aesthetic Computer / St√∏t Aesthetic Computer" />
  <link rel="icon" href="https://aesthetic.computer/purple-pals.svg" type="image/svg+xml" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    @font-face {
      font-family: 'ywft';
      src: url('https://aesthetic.computer/type/webfonts/ywft-processing-regular.woff2') format('woff2'),
           url('https://aesthetic.computer/type/webfonts/ywft-processing-regular.woff') format('woff');
    }
    @font-face {
      font-family: 'berkeley';
      src: url('https://aesthetic.computer/type/webfonts/BerkeleyMonoVariable-Regular.woff2') format('woff2');
    }

    :root {
      --bg: #f4f4f0;
      --text: #1a1a1a;
      --dim: #666;
      --pink: #e84a8a;
      --cyan: #2a9d8f;
      --gold: #d4a017;
      --green: #4a9e5b;
      --box-bg: rgba(0,0,0,0.03);
      --box-border: rgba(0,0,0,0.08);
      --mono: 'berkeley', 'Menlo', monospace;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #1a1a2e;
        --text: #e8e8e8;
        --dim: #888;
        --pink: #ff6b9d;
        --cyan: #4ecdc4;
        --gold: #ffd93d;
        --green: #6bcb77;
        --box-bg: rgba(255,255,255,0.03);
        --box-border: rgba(255,255,255,0.1);
      }
    }

    * { box-sizing: border-box; }

    body {
      font-family: var(--mono);
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 2em;
      min-height: 100vh;
      font-size: 14px;
      line-height: 1.6;
    }

    /* Top bar with logo and language chooser */
    .top-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 16px;
      z-index: 10;
      background: var(--bg);
    }

    /* Simple gift label */
    .logo {
      font-family: 'ywft', sans-serif;
      font-size: 18px;
      cursor: pointer;
      user-select: none;
      color: var(--pink);
    }

    .logo:hover {
      color: var(--cyan);
    }

    .logo-sep {
      color: var(--dim);
      margin: 0 0.3em;
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding-top: 3.5em;
    }

    /* Grid layout for wider screens */
    .content-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1em;
    }

    @media (min-width: 700px) {
      .content-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      .content-grid .full-width {
        grid-column: 1 / -1;
      }
    }

    @media (min-width: 1000px) {
      .content-grid {
        grid-template-columns: repeat(3, 1fr);
      }
      .content-grid .span-2 {
        grid-column: span 2;
      }
    }

    h1 {
      font-family: 'ywft', sans-serif;
      font-weight: normal;
      font-size: 1.8em;
      margin: 0 0 0.5em 0;
      color: var(--text);
      grid-column: 1 / -1;
    }

    h1::before {
      content: "‚ùÑ ";
      opacity: 0.6;
    }

    h1::after {
      content: " ‚ú¶";
      opacity: 0.6;
    }

    h1 .bounce-dot {
      display: inline-block;
      font-weight: 900;
      font-size: 1.1em;
      color: var(--pink);
      animation: dotBounce 1.2s ease-in-out 3;
    }

    @keyframes dotBounce {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-6px) scale(1.2); }
    }

    .holiday-banner {
      font-family: var(--mono);
      font-size: 0.75em;
      color: var(--dim);
      padding: 0.6em;
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 3px;
      text-align: center;
      grid-column: 1 / -1;
    }

    .holiday-banner span { color: var(--gold); }

    /* Prose blocks - language-switchable */
    .prose {
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
      padding: 1em 1.2em;
      font-size: 0.9em;
      line-height: 1.7;
    }

    .prose.full-width {
      grid-column: 1 / -1;
    }

    /* Language content visibility - Danish hidden by default */
    /* Exclude dropdown options from language hiding */
    [data-lang="da"]:not(.lang-option):not(.curr-option) { display: none !important; }
    [data-lang="en"]:not(.lang-option):not(.curr-option) { display: block; }
    
    /* When Danish is selected, flip visibility */
    body.lang-da [data-lang="da"]:not(.lang-option):not(.curr-option) { display: block !important; }
    body.lang-da [data-lang="en"]:not(.lang-option):not(.curr-option) { display: none !important; }

    /* Link description spans */
    .link-desc { display: inline; }
    .link-desc[data-lang="da"] { display: none !important; }
    body.lang-da .link-desc[data-lang="da"] { display: inline !important; }
    body.lang-da .link-desc[data-lang="en"] { display: none !important; }

    /* Feature module list items */
    .feature-module li[data-lang="da"] { display: none !important; }
    body.lang-da .feature-module li[data-lang="da"] { display: block !important; }
    body.lang-da .feature-module li[data-lang="en"] { display: none !important; }

    a { color: var(--cyan); text-decoration: none; }
    a:hover { text-decoration: underline; }

    a.handle-link { color: var(--pink); }

    code {
      background: var(--box-bg);
      padding: 0.15em 0.4em;
      border-radius: 2px;
      color: var(--pink);
    }

    code a { color: var(--pink); }

    /* Stats Section */
    .stats-section {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.6em;
      grid-column: 1 / -1;
    }

    @media (min-width: 800px) {
      .stats-section {
        grid-template-columns: repeat(8, 1fr);
      }
    }

    .stat-item {
      text-align: center;
      padding: 0.6em 0.4em;
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
    }

    .stat-value {
      font-family: 'ywft', var(--mono);
      font-size: 1.2em;
      color: var(--gold);
    }

    .stat-label {
      font-size: 0.6em;
      color: var(--dim);
      margin-top: 0.2em;
    }

    /* Fiat Currency Section */
    .fiat-section {
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
      padding: 1.2em;
    }

    .fiat-section.full-width {
      grid-column: 1 / -1;
    }

    .fiat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1em;
    }

    .fiat-header h2 {
      font-family: 'ywft', sans-serif;
      font-size: 1em;
      margin: 0;
      color: var(--cyan);
    }

    /* Language and Currency dropdowns */
    .selector-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .dropdown-selector {
      position: relative;
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 5px 10px;
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      user-select: none;
    }

    .dropdown-selector:hover {
      border-color: var(--cyan);
    }

    .dropdown-selector .sel-flag { font-size: 14px; }
    .dropdown-selector .sel-text { color: var(--text); font-weight: 500; }
    .dropdown-selector .sel-arrow { font-size: 8px; color: var(--dim); margin-left: 2px; }

    .dropdown-selector.cycling .sel-flag,
    .dropdown-selector.cycling .sel-text {
      animation: selFade 0.3s ease-in-out;
    }

    @keyframes selFade {
      0% { opacity: 1; }
      50% { opacity: 0.3; }
      100% { opacity: 1; }
    }

    .dropdown-menu {
      position: absolute;
      top: calc(100% + 4px);
      right: 0;
      background: var(--bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
      display: none;
      min-width: 100px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 100;
    }

    .dropdown-selector.open .dropdown-menu {
      display: block;
    }

    .dropdown-option {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 12px;
      color: var(--text);
    }

    .dropdown-option:hover {
      background: var(--box-bg);
    }

    .dropdown-option.active {
      color: var(--pink);
      font-weight: bold;
    }

    .currency-pickers {
      width: 100%;
    }

    .currency-picker {
      padding: 0;
    }

    .currency-picker h3 {
      font-family: var(--mono);
      font-size: 0.85em;
      margin: 0 0 0.8em 0;
      color: var(--dim);
    }

    .gift-widget {
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .gift-visual {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2em 1em;
      background: linear-gradient(135deg, rgba(205, 92, 155, 0.1) 0%, rgba(0, 255, 255, 0.05) 100%);
      border: 1px solid var(--box-border);
      border-radius: 8px 8px 0 0;
    }

    .gift-logo-wrap {
      position: relative;
      display: inline-block;
    }

    .gift-logo {
      width: 160px;
      height: 160px;
      opacity: 0.7;
      transition: opacity 0.2s, transform 0.2s;
    }

    .gift-widget:hover .gift-logo {
      opacity: 1;
      transform: scale(1.05);
    }

    .gift-amount {
      position: absolute;
      top: -0.5em;
      right: -2em;
      font-family: 'ywft', var(--mono);
      font-size: 1.3em;
      color: var(--gold);
      background: linear-gradient(135deg, #2a5a3a 0%, #1a3a2a 100%);
      border: 2px solid #4a8a5a;
      border-radius: 4px;
      padding: 0.3em 0.6em;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.1);
      white-space: nowrap;
    }

    .gift-controls {
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .gift-controls input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 12px;
      background: var(--cyan);
      border-radius: 0;
      outline: none;
      cursor: pointer;
      margin: 0;
    }

    .gift-controls input[type="range"] {
      position: relative;
      z-index: 10;
    }

    .gift-controls input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      background: var(--text);
      border-radius: 50%;
      cursor: grab;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      position: relative;
      z-index: 20;
    }

    .gift-controls input[type="range"]::-moz-range-thumb {
      width: 24px;
      height: 24px;
      background: var(--text);
      border-radius: 50%;
      cursor: grab;
      border: none;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    /* Gift mode toggle (one-time vs monthly) - sits below button */
    .gift-mode-toggle {
      display: flex;
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-top: none;
      border-radius: 0 0 8px 8px;
    }

    .mode-btn {
      flex: 1;
      padding: 0.6em 1em;
      font-family: var(--mono);
      font-size: 0.8em;
      background: transparent;
      border: none;
      color: var(--dim);
      cursor: pointer;
      transition: all 0.15s;
    }

    .mode-btn:hover {
      color: var(--text);
    }

    .mode-btn.active {
      background: var(--pink);
      color: var(--bg);
      font-weight: bold;
    }

    .mode-btn[data-mode="once"].active {
      background: var(--cyan);
    }

    .mode-btn[data-mode="monthly"].active {
      background: var(--gold);
    }

    .gift-btn {
      font-family: 'ywft', sans-serif;
      font-size: 1.2em;
      padding: 1em 1.5em;
      background: var(--green);
      color: var(--bg);
      border: none;
      border-radius: 0;
      cursor: pointer;
      width: 100%;
      transition: background 0.15s;
      font-weight: bold;
      letter-spacing: 0.02em;
    }

    .gift-btn:hover {
      background: var(--pink);
    }

    .gift-btn:disabled {
      opacity: 0.7;
      cursor: wait;
    }

    /* Crypto controls */
    .crypto-controls {
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .crypto-address {
      background: var(--box-bg);
      padding: 1em;
      text-align: center;
      border-left: 1px solid var(--box-border);
      border-right: 1px solid var(--box-border);
    }

    .crypto-label {
      display: block;
      font-family: 'ywft', sans-serif;
      font-size: 1.1em;
      color: var(--cyan);
      margin-bottom: 0.5em;
    }

    .crypto-addr {
      display: block;
      font-family: var(--mono);
      font-size: 0.7em;
      color: var(--dim);
      word-break: break-all;
      background: transparent;
      padding: 0;
    }

    .crypto-amount {
      background: linear-gradient(135deg, #3a2a5a 0%, #2a1a4a 100%);
      border-color: #6a4a8a;
    }

    .crypto-usd {
      position: absolute;
      bottom: 0.5em;
      right: 0.5em;
      font-family: var(--mono);
      font-size: 0.85em;
      color: var(--gold);
      opacity: 0.9;
    }

    .gift-widget.crypto .gift-visual {
      background: linear-gradient(135deg, rgba(106, 74, 138, 0.2) 0%, rgba(0, 255, 255, 0.05) 100%);
    }

    .crypto-slider {
      -webkit-appearance: none;
      width: 100%;
      height: 12px;
      background: linear-gradient(90deg, var(--pink) 0%, #6a4a8a 100%);
      border-radius: 0;
      outline: none;
      cursor: pointer;
      margin: 0;
      border-left: 1px solid var(--box-border);
      border-right: 1px solid var(--box-border);
    }

    .crypto-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      background: var(--text);
      border-radius: 50%;
      cursor: grab;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .crypto-slider::-moz-range-thumb {
      width: 24px;
      height: 24px;
      background: var(--text);
      border-radius: 50%;
      cursor: grab;
      border: none;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .crypto-buttons {
      display: flex;
      gap: 0;
    }

    .crypto-send {
      flex: 2;
      border-radius: 0 0 0 8px;
      background: linear-gradient(135deg, #6a4a8a 0%, #4a2a6a 100%);
    }

    .crypto-send:hover {
      background: linear-gradient(135deg, #8a6aaa 0%, #6a4a8a 100%);
    }

    .crypto-copy {
      flex: 1;
      border-radius: 0 0 8px 0;
      background: var(--dim);
      font-size: 0.9em;
    }

    .crypto-copy:hover {
      background: var(--text);
      color: var(--bg);
    }

    small {
      display: block;
      font-size: 0.7em;
      color: var(--dim);
      text-align: center;
      grid-column: 1 / -1;
      margin: 0.5em 0;
    }

    hr {
      border: none;
      border-top: 1px dashed var(--box-border);
      grid-column: 1 / -1;
      margin: 0.5em 0;
    }

    .digital-currency {
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
      padding: 1em 1.2em;
    }

    .digital-currency h3 {
      font-family: 'ywft', sans-serif;
      font-size: 0.9em;
      margin: 0 0 0.8em 0;
      color: var(--cyan);
    }

    .crypto-row {
      display: flex;
      gap: 1em;
      flex-wrap: wrap;
    }

    .crypto-item {
      flex: 1;
      min-width: 140px;
    }

    .link-block {
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
      padding: 1em 1.2em;
      display: flex;
      flex-direction: column;
      gap: 0.3em;
    }

    .link-block strong {
      color: var(--pink);
      font-family: 'ywft', sans-serif;
      font-size: 0.9em;
    }

    .link-block a {
      color: var(--cyan);
      font-family: var(--mono);
      font-size: 0.9em;
    }

    .link-block .link-desc {
      font-size: 0.8em;
      color: var(--dim);
      margin-top: 0.2em;
    }

    .feature-module {
      background: var(--box-bg);
      border: 1px solid var(--box-border);
      border-radius: 4px;
      padding: 1em 1.2em;
    }

    .feature-module h3 {
      font-family: 'ywft', sans-serif;
      font-size: 0.95em;
      margin: 0 0 0.7em 0;
      color: var(--cyan);
    }

    .feature-module ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 0.5em;
    }

    .feature-module li {
      font-size: 0.85em;
      line-height: 1.4;
      padding-left: 0.5em;
      border-left: 2px solid var(--box-border);
    }

    .feature-module li strong {
      color: var(--pink);
    }

    .feature-module li a {
      color: inherit;
      text-decoration: none;
    }

    .feature-module li a:hover {
      text-decoration: underline;
    }

    .feature-module li a strong {
      color: var(--pink);
    }

    .addr {
      font-size: 0.85em;
      background: var(--box-bg);
      padding: 0.3em 0.5em;
      border-radius: 2px;
      display: inline-flex;
      align-items: center;
      gap: 0.5em;
      margin-top: 0.2em;
    }

    .addr button {
      font-family: var(--mono);
      font-size: 0.75em;
      padding: 0.2em 0.4em;
      background: transparent;
      border: 1px solid var(--dim);
      color: var(--dim);
      border-radius: 2px;
      cursor: pointer;
    }

    .addr button:hover {
      border-color: var(--cyan);
      color: var(--cyan);
    }

    /* Shop Section - constrained width with distinct background */
    .shop-section {
      background: linear-gradient(135deg, rgba(42, 157, 143, 0.08) 0%, rgba(205, 92, 155, 0.08) 100%);
      border: 1px solid var(--box-border);
      border-radius: 8px;
      padding: 1.2em;
      color: var(--text);
      max-width: 320px;
    }

    .shop-header {
      display: flex;
      align-items: baseline;
      gap: 1em;
      margin-bottom: 1em;
      flex-wrap: wrap;
    }

    .shop-title {
      font-family: 'ywft', sans-serif;
      font-size: 1.4em;
      color: var(--text);
      text-decoration: none;
    }

    .shop-title:hover {
      color: var(--pink);
    }

    .shop-tagline {
      font-size: 0.85em;
      color: var(--dim);
    }

    .shop-products {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 180px;
      position: relative;
    }

    .shop-product {
      text-decoration: none;
      color: var(--text);
      text-align: center;
      opacity: 0;
      transform: scale(0.95);
      animation: shopFadeIn 0.4s ease forwards;
    }

    @keyframes shopFadeIn {
      to { opacity: 1; transform: scale(1); }
    }

    .shop-product:hover {
      transform: scale(1.03);
    }

    .shop-product img {
      width: 140px;
      height: 140px;
      object-fit: cover;
      border-radius: 4px;
      background: var(--box-bg);
      border: 1px solid var(--box-border);
    }

    .shop-product-title {
      font-size: 0.8em;
      margin-top: 0.5em;
      line-height: 1.3;
      max-width: 160px;
    }

    .shop-product-price {
      font-family: var(--mono);
      font-size: 0.7em;
      color: var(--dim);
      margin-top: 0.2em;
    }

    .shop-product-sold {
      color: var(--pink);
      font-size: 0.65em;
      text-transform: uppercase;
    }

    .shop-loading {
      color: var(--dim);
      font-size: 0.85em;
      text-align: center;
      padding: 2em;
    }

    /* TV Section - letterbox video feed */
    .tv-section {
      background: #000;
      border-radius: 8px;
      overflow: hidden;
    }

    .tv-header {
      display: flex;
      flex-direction: column;
      gap: 0.2em;
      padding: 0.8em 1em;
      text-decoration: none;
      background: rgba(255,255,255,0.05);
    }

    .tv-header strong {
      color: #fff;
      font-family: 'ywft', sans-serif;
      font-size: 0.9em;
    }

    .tv-header .link-desc {
      font-size: 0.75em;
      color: rgba(255,255,255,0.5);
    }

    .tv-header:hover strong {
      color: var(--pink);
    }

    .tv-player {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .tv-player video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: #000;
    }

    .tv-loading {
      font-size: 2em;
      opacity: 0.3;
      animation: tvPulse 1.5s ease-in-out infinite;
    }

    @keyframes tvPulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.6; }
    }

    .tv-no-signal {
      color: rgba(255,255,255,0.3);
      font-size: 0.8em;
      font-family: var(--mono);
    }

    #pals {
      display: flex;
      align-items: center;
      justify-content: center;
      grid-column: 1 / -1;
    }

    #pals img {
      width: 48px;
      opacity: 0.3;
    }

    #pals:hover img {
      opacity: 1;
    }

    /* Mobile adjustments */
    @media (max-width: 699px) {
      .stats-section {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 400px) {
      .stats-section {
        grid-template-columns: repeat(2, 1fr);
      }
      .stat-item { min-width: unset; }
    }
  </style>
</head>

<body>
  <div class="top-bar">
    <div class="logo" onclick="window.location.href='https://aesthetic.computer'">give<span class="logo-sep">‚Äî</span>Aesthetic<span class="bounce-dot">.</span>Computer</div>
    <div class="selector-group">
      <div class="dropdown-selector" id="langSelector">
        <span class="sel-flag">üá∫üá∏</span>
        <span class="sel-text">EN</span>
        <span class="sel-arrow">‚ñº</span>
        <div class="dropdown-menu">
          <div class="dropdown-option active" data-lang="en">
            <span>üá∫üá∏</span> <span>English</span>
          </div>
          <div class="dropdown-option" data-lang="da">
            <span>üá©üá∞</span> <span>Dansk</span>
          </div>
        </div>
      </div>
      <div class="dropdown-selector" id="currSelector">
        <span class="sel-flag">üíµ</span>
        <span class="sel-text">USD</span>
        <span class="sel-arrow">‚ñº</span>
        <div class="dropdown-menu">
          <div class="dropdown-option active" data-curr="usd">
            <span>üíµ</span> <span>USD</span>
          </div>
          <div class="dropdown-option" data-curr="dkk">
            <span>üí∂</span> <span>DKK</span>
          </div>
          <div class="dropdown-option" data-curr="xtz">
            <span>üîÆ</span> <span>Tezos</span>
          </div>
          <div class="dropdown-option" data-curr="eth">
            <span>üíé</span> <span>Ethereum</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <main>
    <div class="content-grid">
      <div class="fiat-section full-width">
        <div class="fiat-header">
          <h2 data-lang="en">üéÅ Give</h2>
          <h2 data-lang="da">üéÅ Giv</h2>
        </div>
        <div class="currency-pickers">
          <div class="currency-picker" data-for="usd">
            <div class="gift-widget" data-currency="usd">
              <div class="gift-visual">
                <div class="gift-logo-wrap">
                  <img src="https://aesthetic.computer/purple-pals.svg" class="gift-logo" alt="">
                  <div class="gift-amount">$125</div>
                </div>
              </div>
              <div class="gift-controls">
                <input type="range" min="5" max="500" step="5" value="125">
                <button class="gift-btn" data-currency="usd">Give $125</button>
                <div class="gift-mode-toggle">
                  <button class="mode-btn active" data-mode="once">One-time</button>
                  <button class="mode-btn" data-mode="monthly">Monthly</button>
                </div>
              </div>
            </div>
          </div>
          <div class="currency-picker" data-for="dkk" style="display: none;">
            <div class="gift-widget" data-currency="dkk">
              <div class="gift-visual">
                <div class="gift-logo-wrap">
                  <img src="https://aesthetic.computer/purple-pals.svg" class="gift-logo" alt="">
                  <div class="gift-amount">200 kr</div>
                </div>
              </div>
              <div class="gift-controls">
                <input type="range" min="25" max="7000" step="25" value="200">
                <button class="gift-btn" data-currency="dkk">Giv 200 kr</button>
              </div>
            </div>
          </div>
          <div class="currency-picker" data-for="xtz" style="display: none;">
            <div class="gift-widget crypto" data-currency="xtz">
              <div class="gift-visual">
                <div class="gift-logo-wrap">
                  <img src="https://aesthetic.computer/purple-pals.svg" class="gift-logo" alt="">
                  <div class="gift-amount crypto-amount">üîÆ 10 Íú©</div>
                </div>
                <div class="crypto-usd" data-currency="xtz">‚âà $‚Äî</div>
              </div>
              <div class="crypto-controls">
                <input type="range" class="crypto-slider" min="1" max="100" step="1" value="10" data-currency="xtz">
                <div class="crypto-address">
                  <span class="crypto-label">aesthetic.tez</span>
                  <code class="crypto-addr">tz1WqvhbfEwfqAzMtEGxc7x6tpSqRMCNKPCT</code>
                </div>
                <div class="crypto-buttons">
                  <button class="gift-btn crypto-send" data-currency="xtz">Send 10 Íú©</button>
                  <button class="gift-btn crypto-copy" onclick="copy('tz1WqvhbfEwfqAzMtEGxc7x6tpSqRMCNKPCT', this)">Copy</button>
                </div>
              </div>
            </div>
          </div>
          <div class="currency-picker" data-for="eth" style="display: none;">
            <div class="gift-widget crypto" data-currency="eth">
              <div class="gift-visual">
                <div class="gift-logo-wrap">
                  <img src="https://aesthetic.computer/purple-pals.svg" class="gift-logo" alt="">
                  <div class="gift-amount crypto-amount">üíé 0.05 Œû</div>
                </div>
                <div class="crypto-usd" data-currency="eth">‚âà $‚Äî</div>
              </div>
              <div class="crypto-controls">
                <input type="range" class="crypto-slider" min="0.01" max="1" step="0.01" value="0.05" data-currency="eth">
                <div class="crypto-address">
                  <span class="crypto-label">4esthetic.eth</span>
                  <code class="crypto-addr">0x1D64E3eFa983D945cBFe29Ad5b3C8ABB53Aef023</code>
                </div>
                <div class="crypto-buttons">
                  <button class="gift-btn crypto-send" data-currency="eth">Send 0.05 Œû</button>
                  <button class="gift-btn crypto-copy" onclick="copy('0x1D64E3eFa983D945cBFe29Ad5b3C8ABB53Aef023', this)">Copy</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <small class="fiat-note" data-lang="en">Card payments via Stripe. Crypto sent directly. Not tax-deductible.</small>
        <small class="fiat-note" data-lang="da">Kortbetalinger via Stripe. Crypto sendes direkte. Ikke fradragsberettiget.</small>
      </div>

      <div class="prose full-width" data-lang="en">
        <a href="https://aesthetic.computer">Aesthetic Computer</a> is a runtime and social network for creative computing‚Äîan instrument for making and sharing interactive software. It's the full-time work of <a href="https://aesthetic.computer/@jeffrey" class="handle-link">@jeffrey</a>, who has been building experimental software instruments for over a decade. He lives in Echo Park, Los Angeles, and regularly demos the software at the <a href="https://nelacomputer.club">NELA Computer Club</a> in Chinatown.
      </div>
      <div class="prose full-width" data-lang="da">
        <a href="https://aesthetic.computer">Aesthetic Computer</a> er en runtime og socialt netv√¶rk for kreativ computing‚Äîet instrument til at lave og dele interaktiv software. Det er fuldtidsarbejdet af <a href="https://aesthetic.computer/@jeffrey" class="handle-link">@jeffrey</a>, som har bygget eksperimentelle software-instrumenter i over et √•rti. Han bor i Echo Park, Los Angeles, og demonstrerer regelm√¶ssigt softwaren ved <a href="https://nelacomputer.club">NELA Computer Club</a> i Chinatown.
      </div>

      <div class="stats-section">
        <div class="stat-item">
          <div class="stat-value">4,217</div>
          <div class="stat-label">users</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">4,108</div>
          <div class="stat-label">paintings</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">2,827</div>
          <div class="stat-label">moods</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">12,933</div>
          <div class="stat-label">kidlisp</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">847</div>
          <div class="stat-label">pieces</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">156</div>
          <div class="stat-label">prompts</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">3</div>
          <div class="stat-label">years</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">1</div>
          <div class="stat-label">developer</div>
        </div>
      </div>

      <a href="https://kidlisp.com" class="link-block" style="text-decoration: none;">
        <strong class="kidlisp-logo" style="font-family: 'Comic Sans MS', cursive; font-size: 1.1em;"><span style="color:#FF6B6B">K</span><span style="color:#4ECDC4">i</span><span style="color:#FFE66D">d</span><span style="color:#95E1D3">L</span><span style="color:#F38181">i</span><span style="color:#AA96DA">s</span><span style="color:#70D6FF">p</span><span style="color:var(--dim)">.</span><span style="color:#70D6FF">com</span></strong>
        <span class="link-desc" data-lang="en">A creative coding language for all ages</span>
        <span class="link-desc" data-lang="da">Et kreativt kodesprog for alle aldre</span>
      </a>

      <div class="link-block">
        <strong>üïê laer-klokken</strong>
        <a href="https://aesthetic.computer/laer-klokken">aesthetic.computer/laer-klokken</a>
        <span class="link-desc" data-lang="en">Clock lessons for Danish schools</span>
        <span class="link-desc" data-lang="da">Klokke-lektioner til danske skoler</span>
      </div>

      <div class="link-block">
        <strong>üéπ notepat</strong>
        <a href="https://aesthetic.computer/notepat">aesthetic.computer/notepat</a>
        <span class="link-desc" data-lang="en">A visual music sequencer</span>
        <span class="link-desc" data-lang="da">En visuel musik-sequencer</span>
      </div>

      <div class="tv-section">
        <a href="https://aesthetic.computer/tv" class="tv-header">
          <strong>üì∫ tv</strong>
          <span class="link-desc" data-lang="en">Community video feed</span>
          <span class="link-desc" data-lang="da">F√¶llesskabets video-feed</span>
        </a>
        <div class="tv-player" id="tvPlayer">
          <div class="tv-loading">üì∫</div>
        </div>
      </div>

      <div class="link-block">
        <strong>üñ•Ô∏è desktop</strong>
        <a href="https://aesthetic.computer/desktop">aesthetic.computer/desktop</a>
        <span class="link-desc" data-lang="en">Native apps for Mac, Windows & Linux</span>
        <span class="link-desc" data-lang="da">Native apps til Mac, Windows & Linux</span>
      </div>

      <div class="shop-section">
        <div class="shop-header">
          <a href="https://shop.aesthetic.computer" class="shop-title">shop</a>
          <span class="shop-tagline" data-lang="en">paintings, books, bikes, music & more</span>
          <span class="shop-tagline" data-lang="da">malerier, b√∏ger, cykler, musik & mere</span>
        </div>
        <div class="shop-products" id="shopProducts">
          <div class="shop-loading">Loading...</div>
        </div>
      </div>

      <div class="link-block">
        <strong>üìà</strong> <span data-lang="en"><strong>Invest</strong></span><span data-lang="da"><strong>Invest√©r</strong></span>
        <a href="https://aesthetic.direct">aesthetic.direct</a>
        <span class="link-desc" data-lang="en">Equity investment opportunities</span>
        <span class="link-desc" data-lang="da">Aktieinvesteringsmuligheder</span>
      </div>

      <a id="pals" href="https://aesthetic.computer">
        <img src="https://aesthetic.computer/purple-pals.svg" alt="AC">
      </a>
    </div>
  </main>

  <script>
    // Language selector
    const langSelector = document.getElementById('langSelector');
    const langFlag = langSelector.querySelector('.sel-flag');
    const langText = langSelector.querySelector('.sel-text');
    const langOptions = langSelector.querySelectorAll('.dropdown-option');
    
    // Currency selector
    const currSelector = document.getElementById('currSelector');
    const currFlag = currSelector.querySelector('.sel-flag');
    const currText = currSelector.querySelector('.sel-text');
    const currOptions = currSelector.querySelectorAll('.dropdown-option');
    const currencyPickers = document.querySelectorAll('.currency-picker');

    // Language data for cycling
    const languages = [
      { code: 'en', flag: 'üá∫üá∏', text: 'EN', name: 'English' },
      { code: 'da', flag: 'üá©üá∞', text: 'DA', name: 'Dansk' }
    ];
    
    // Currency data for cycling
    const currencies = [
      { code: 'usd', flag: 'üíµ', text: 'USD', name: 'USD' },
      { code: 'dkk', flag: 'üí∂', text: 'DKK', name: 'DKK' },
      { code: 'xtz', flag: 'üîÆ', text: 'XTZ', name: 'Tezos' },
      { code: 'eth', flag: 'üíé', text: 'ETH', name: 'Ethereum' }
    ];

    // Dropdown toggle
    function setupDropdown(selector) {
      selector.addEventListener('click', (e) => {
        if (e.target.closest('.dropdown-option')) return;
        e.stopPropagation();
        // Close other dropdowns
        document.querySelectorAll('.dropdown-selector.open').forEach(s => {
          if (s !== selector) s.classList.remove('open');
        });
        selector.classList.toggle('open');
      });
    }
    
    setupDropdown(langSelector);
    setupDropdown(currSelector);
    
    // Close dropdowns on outside click
    document.addEventListener('click', () => {
      document.querySelectorAll('.dropdown-selector.open').forEach(s => s.classList.remove('open'));
    });

    // Language selection
    langOptions.forEach(opt => {
      opt.addEventListener('click', (e) => {
        e.stopPropagation();
        const lang = opt.dataset.lang;
        setLanguage(lang);
        updateLangUI(lang);
        langSelector.classList.remove('open');
        localStorage.setItem('gift-lang', lang);
      });
    });
    
    function updateLangUI(lang) {
      const info = languages.find(l => l.code === lang) || languages[0];
      langFlag.textContent = info.flag;
      langText.textContent = info.text;
      langOptions.forEach(opt => opt.classList.toggle('active', opt.dataset.lang === lang));
    }

    // Currency selection
    currOptions.forEach(opt => {
      opt.addEventListener('click', (e) => {
        e.stopPropagation();
        const curr = opt.dataset.curr;
        setCurrency(curr);
        currSelector.classList.remove('open');
        localStorage.setItem('gift-curr', curr);
      });
    });
    
    function setCurrency(curr) {
      const info = currencies.find(c => c.code === curr) || currencies[0];
      currFlag.textContent = info.flag;
      currText.textContent = info.text;
      currOptions.forEach(opt => opt.classList.toggle('active', opt.dataset.curr === curr));
      currencyPickers.forEach(picker => {
        picker.style.display = picker.dataset.for === curr ? '' : 'none';
      });
    }

    // Auto-cycle animation for language selector
    let langCycleIndex = 0;
    setTimeout(() => {
      setInterval(() => {
        langCycleIndex = (langCycleIndex + 1) % languages.length;
        const preview = languages[langCycleIndex];
        
        langSelector.classList.add('cycling');
        setTimeout(() => {
          langFlag.textContent = preview.flag;
          langText.textContent = preview.text;
        }, 150);
        setTimeout(() => {
          langSelector.classList.remove('cycling');
          // Restore actual selection
          const actual = languages.find(l => l.code === currentLang) || languages[0];
          setTimeout(() => {
            langFlag.textContent = actual.flag;
            langText.textContent = actual.text;
          }, 2000);
        }, 300);
      }, 4000);
    }, 2000);

    // Auto-cycle animation for currency selector
    let currCycleIndex = 0;
    setTimeout(() => {
      setInterval(() => {
        currCycleIndex = (currCycleIndex + 1) % currencies.length;
        const preview = currencies[currCycleIndex];
        
        currSelector.classList.add('cycling');
        setTimeout(() => {
          currFlag.textContent = preview.flag;
          currText.textContent = preview.text;
        }, 150);
        setTimeout(() => {
          currSelector.classList.remove('cycling');
          // Restore actual selection
          const savedCurr = localStorage.getItem('gift-curr') || 'usd';
          const actual = currencies.find(c => c.code === savedCurr) || currencies[0];
          setTimeout(() => {
            currFlag.textContent = actual.flag;
            currText.textContent = actual.text;
          }, 2000);
        }, 300);
      }, 3000);
    }, 1000);

    // Load saved language or detect from browser
    let currentLang = localStorage.getItem('gift-lang');
    if (!currentLang) {
      currentLang = navigator.language.startsWith('da') ? 'da' : 'en';
    }
    setLanguage(currentLang);
    updateLangUI(currentLang);
    
    // Restore saved currency
    const savedCurr = localStorage.getItem('gift-curr');
    if (savedCurr) {
      setCurrency(savedCurr);
    } else if (currentLang === 'da') {
      setCurrency('dkk');
    } else {
      setCurrency('usd');
    }

    function setLanguage(lang) {
      currentLang = lang;
      document.body.classList.toggle('lang-da', lang === 'da');

      // Update fiat button text (skip crypto widgets)
      document.querySelectorAll('.gift-widget:not(.crypto)').forEach(widget => {
        const currency = widget.dataset.currency;
        const slider = widget.querySelector('input[type="range"]');
        if (!slider) return;
        const value = parseInt(slider.value);
        const btn = widget.querySelector('.gift-btn');
        const isMonthly = widget._isMonthly ? widget._isMonthly() : false;
        if (currency === 'dkk') {
          btn.textContent = lang === 'da' ? `Giv ${value} kr` : `Give ${value} kr`;
        } else if (isMonthly) {
          btn.textContent = lang === 'da' ? `Giv $${value}/m√•ned` : `Give $${value}/month`;
        } else {
          btn.textContent = lang === 'da' ? `Giv $${value}` : `Give $${value}`;
        }
      });
      
      // Update crypto button text
      document.querySelectorAll('.gift-widget.crypto .crypto-copy').forEach(btn => {
        btn.textContent = lang === 'da' ? 'Kopi√©r' : 'Copy';
      });
      
      // Update crypto send button text
      document.querySelectorAll('.gift-widget.crypto').forEach(widget => {
        const slider = widget.querySelector('.crypto-slider');
        const sendBtn = widget.querySelector('.crypto-send');
        if (slider && sendBtn) {
          const currency = slider.dataset.currency;
          const value = currency === 'eth' ? parseFloat(slider.value).toFixed(2) : parseInt(slider.value);
          const symbol = currency === 'eth' ? 'Œû' : 'Íú©';
          sendBtn.textContent = lang === 'da' ? `Send ${value} ${symbol}` : `Send ${value} ${symbol}`;
        }
      });
    }

    // Slider functionality
    document.querySelectorAll('.gift-widget:not(.crypto)').forEach(widget => {
      const currency = widget.dataset.currency;
      const slider = widget.querySelector('input[type="range"]');
      const amountEl = widget.querySelector('.gift-amount');
      const btn = widget.querySelector('.gift-btn');
      const modeToggle = widget.querySelector('.gift-mode-toggle');
      let isMonthly = false;

      // Mode toggle for USD
      if (modeToggle) {
        modeToggle.querySelectorAll('.mode-btn').forEach(modeBtn => {
          modeBtn.addEventListener('click', () => {
            modeToggle.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            modeBtn.classList.add('active');
            isMonthly = modeBtn.dataset.mode === 'monthly';
            
            // Adjust slider range for monthly vs one-time
            if (isMonthly) {
              slider.min = 5;
              slider.max = 100;
              slider.step = 5;
              if (parseInt(slider.value) > 100) slider.value = 25;
            } else {
              slider.min = 5;
              slider.max = 500;
              slider.step = 5;
            }
            update();
          });
        });
      }

      function format(v) {
        return currency === 'dkk' ? `${v} kr` : `$${v}`;
      }

      function update() {
        const value = parseInt(slider.value);
        const suffix = isMonthly ? '/mo' : '';
        amountEl.textContent = format(value) + suffix;
        const lang = document.body.classList.contains('lang-da') ? 'da' : 'en';
        if (currency === 'dkk') {
          btn.textContent = lang === 'da' ? `Giv ${format(value)}` : `Give ${format(value)}`;
        } else if (isMonthly) {
          btn.textContent = lang === 'da' ? `Giv ${format(value)}/m√•ned` : `Give ${format(value)}/month`;
        } else {
          btn.textContent = lang === 'da' ? `Giv ${format(value)}` : `Give ${format(value)}`;
        }
      }

      slider.addEventListener('input', update);
      update();
      
      // Store isMonthly state on widget for button handler
      widget._isMonthly = () => isMonthly;
    });

    document.querySelectorAll('.gift-widget:not(.crypto) .gift-btn').forEach(btn => {
      btn.onclick = async () => {
        const currency = btn.dataset.currency;
        const widget = btn.closest('.gift-widget');
        const slider = widget.querySelector('input[type="range"]');
        const value = parseInt(slider.value);
        const isMonthly = widget._isMonthly ? widget._isMonthly() : false;
        
        btn.textContent = currentLang === 'da' ? 'Omdirigerer...' : 'Redirecting...';
        btn.disabled = true;

        try {
          const res = await fetch('https://aesthetic.computer/api/give', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ amount: value * 100, currency, recurring: isMonthly })
          });
          const data = await res.json();
          if (data.url) window.location.href = data.url;
          else throw new Error(data.error || 'No URL returned');
        } catch (err) {
          console.error('Give error:', err);
          const fmt = currency === 'dkk' ? `${value} kr` : `$${value}`;
          const suffix = isMonthly ? '/month' : '';
          btn.textContent = currentLang === 'da' ? `Giv ${fmt}${isMonthly ? '/m√•ned' : ''}` : `Give ${fmt}${suffix}`;
          btn.disabled = false;
          alert(currentLang === 'da' ? 'Noget gik galt' : 'Something went wrong');
        }
      };
    });

    function copy(text, btn) {
      navigator.clipboard.writeText(text);
      const origText = btn.textContent;
      btn.textContent = currentLang === 'da' ? 'Kopieret!' : 'Copied!';
      setTimeout(() => btn.textContent = currentLang === 'da' ? 'Kopi√©r' : 'Copy', 1500);
    }

    // Crypto prices
    let cryptoPrices = { xtz: null, eth: null };
    
    async function fetchCryptoPrices() {
      try {
        const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=tezos,ethereum&vs_currencies=usd');
        const data = await res.json();
        cryptoPrices.xtz = data.tezos?.usd || null;
        cryptoPrices.eth = data.ethereum?.usd || null;
        updateAllCryptoDisplays();
      } catch (e) {
        console.log('Could not fetch crypto prices');
      }
    }
    
    function updateAllCryptoDisplays() {
      document.querySelectorAll('.crypto-slider').forEach(slider => {
        const currency = slider.dataset.currency;
        const widget = slider.closest('.gift-widget');
        updateCryptoDisplay(widget, slider, currency);
      });
    }
    
    function updateCryptoDisplay(widget, slider, currency) {
      const amountEl = widget.querySelector('.gift-amount');
      const sendBtn = widget.querySelector('.crypto-send');
      const usdEl = widget.querySelector('.crypto-usd');
      
      const value = currency === 'eth' ? parseFloat(slider.value).toFixed(2) : parseInt(slider.value);
      const symbol = currency === 'eth' ? 'Œû' : 'Íú©';
      const emoji = currency === 'eth' ? 'üíé' : 'üîÆ';
      
      amountEl.textContent = `${emoji} ${value} ${symbol}`;
      sendBtn.textContent = `Send ${value} ${symbol}`;
      
      const price = cryptoPrices[currency];
      if (price && usdEl) {
        const usdValue = (parseFloat(value) * price).toFixed(2);
        usdEl.textContent = `‚âà $${usdValue}`;
      }
    }

    // Crypto slider functionality
    document.querySelectorAll('.crypto-slider').forEach(slider => {
      const widget = slider.closest('.gift-widget');
      const currency = slider.dataset.currency;
      
      slider.addEventListener('input', () => updateCryptoDisplay(widget, slider, currency));
      updateCryptoDisplay(widget, slider, currency);
    });
    
    // Fetch prices on load
    fetchCryptoPrices();

    // Tezos wallet connect (Beacon)
    async function sendTezos(amount) {
      const btn = document.querySelector('[data-currency="xtz"].crypto-send');
      const origText = btn.textContent;
      
      try {
        btn.textContent = currentLang === 'da' ? 'Forbinder...' : 'Connecting...';
        btn.disabled = true;
        
        // Use Beacon SDK via script tag approach
        if (!window.beacon) {
          // Load Beacon SDK
          await new Promise((resolve, reject) => {
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/@airgap/beacon-sdk@4.0.12/dist/walletbeacon.min.js';
            script.onload = resolve;
            script.onerror = reject;
            document.head.appendChild(script);
          });
        }
        
        const client = new window.beacon.DAppClient({ name: 'Aesthetic Computer Gift' });
        
        btn.textContent = currentLang === 'da' ? 'V√¶lg tegnebog...' : 'Select wallet...';
        await client.requestPermissions();
        
        btn.textContent = currentLang === 'da' ? 'Bekr√¶ft i tegnebog...' : 'Confirm in wallet...';
        const response = await client.requestOperation({
          operationDetails: [{
            kind: 'transaction',
            destination: 'tz1WqvhbfEwfqAzMtEGxc7x6tpSqRMCNKPCT',
            amount: String(Math.floor(amount * 1000000)) // mutez
          }]
        });
        
        btn.textContent = currentLang === 'da' ? '‚úì Sendt!' : '‚úì Sent!';
        console.log('TX:', response.transactionHash);
        setTimeout(() => {
          btn.textContent = origText;
          btn.disabled = false;
        }, 3000);
        
      } catch (err) {
        console.error('Tezos error:', err);
        btn.textContent = err.message?.includes('Aborted') 
          ? (currentLang === 'da' ? 'Annulleret' : 'Cancelled')
          : (currentLang === 'da' ? 'Fejl - pr√∏v igen' : 'Error - try again');
        setTimeout(() => {
          btn.textContent = origText;
          btn.disabled = false;
        }, 2000);
      }
    }

    // Ethereum wallet connect
    async function sendEthereum(amount) {
      const btn = document.querySelector('[data-currency="eth"].crypto-send');
      const origText = btn.textContent;
      
      try {
        btn.textContent = currentLang === 'da' ? 'Forbinder...' : 'Connecting...';
        btn.disabled = true;
        
        if (!window.ethereum) {
          alert(currentLang === 'da' ? 'Install√©r MetaMask eller en anden Ethereum-tegnebog' : 'Please install MetaMask or another Ethereum wallet');
          throw new Error('No wallet');
        }
        
        btn.textContent = currentLang === 'da' ? 'Godkend forbindelse...' : 'Approve connection...';
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        
        if (!accounts.length) throw new Error('No account');
        
        const amountWei = '0x' + (BigInt(Math.floor(amount * 1e18))).toString(16);
        
        btn.textContent = currentLang === 'da' ? 'Bekr√¶ft i tegnebog...' : 'Confirm in wallet...';
        const txHash = await window.ethereum.request({
          method: 'eth_sendTransaction',
          params: [{
            from: accounts[0],
            to: '0x1D64E3eFa983D945cBFe29Ad5b3C8ABB53Aef023',
            value: amountWei
          }]
        });
        
        btn.textContent = currentLang === 'da' ? '‚úì Sendt!' : '‚úì Sent!';
        console.log('TX:', txHash);
        setTimeout(() => {
          btn.textContent = origText;
          btn.disabled = false;
        }, 3000);
        
      } catch (err) {
        console.error('Ethereum error:', err);
        if (err.message !== 'No wallet') {
          btn.textContent = currentLang === 'da' ? 'Annulleret' : 'Cancelled';
        }
        setTimeout(() => {
          btn.textContent = origText;
          btn.disabled = false;
        }, 2000);
      }
    }

    // Wire up crypto send buttons
    document.querySelectorAll('.crypto-send').forEach(btn => {
      btn.addEventListener('click', () => {
        const widget = btn.closest('.gift-widget');
        const slider = widget.querySelector('.crypto-slider');
        const currency = slider.dataset.currency;
        const value = currency === 'eth' ? parseFloat(slider.value) : parseInt(slider.value);
        
        if (currency === 'xtz') {
          sendTezos(value);
        } else if (currency === 'eth') {
          sendEthereum(value);
        }
      });
    });

    // Live reload in dev mode
    if (location.hostname === 'localhost' || location.hostname.includes('local')) {
      const wsUrl = location.protocol === 'https:' 
        ? 'wss://localhost:8889' 
        : 'ws://localhost:8889';
      
      function connectWS() {
        const ws = new WebSocket(wsUrl);
        ws.onopen = () => console.log('üîÑ Live reload connected');
        ws.onmessage = (e) => {
          try {
            const msg = JSON.parse(e.data);
            if (msg.type === 'reload' && msg.content?.piece === '*refresh*') {
              console.log('üîÑ Reloading...');
              location.reload();
            }
          } catch {}
        };
        ws.onclose = () => setTimeout(connectWS, 2000);
        ws.onerror = () => ws.close();
      }
      connectWS();
    }

    // Fetch shop products - single rotating display
    let shopProducts = [];
    let shopIndex = 0;
    
    async function loadShopProducts() {
      const container = document.getElementById('shopProducts');
      try {
        const res = await fetch('https://aesthetic.computer/api/shop');
        const data = await res.json();
        
        if (!data.products?.length) {
          container.innerHTML = '<div class="shop-loading">No products available</div>';
          return;
        }
        
        shopProducts = data.products;
        showShopProduct(0);
        
        // Rotate every 4 seconds
        setInterval(() => {
          shopIndex = (shopIndex + 1) % shopProducts.length;
          showShopProduct(shopIndex);
        }, 4000);
      } catch (e) {
        console.error('Shop load error:', e);
        container.innerHTML = '<a href="https://shop.aesthetic.computer" class="shop-loading">Visit shop ‚Üí</a>';
      }
    }
    
    function showShopProduct(index) {
      const container = document.getElementById('shopProducts');
      const p = shopProducts[index];
      if (!p) return;
      
      container.innerHTML = `
        <a href="${p.shopUrl}" class="shop-product" target="_blank">
          <img src="${p.imageUrl || ''}" alt="${p.title}" loading="lazy">
          <div class="shop-product-title">${p.title}</div>
          ${p.available 
            ? `<div class="shop-product-price">${p.price}</div>`
            : `<div class="shop-product-sold">SOLD</div>`
          }
        </a>
      `;
    }
    loadShopProducts();

    // TV video feed - load and cycle through tape videos
    let tvTapes = [];
    let tvIndex = 0;
    let tvPlayer = null;
    let tvErrorCount = 0;
    const TV_MAX_ERRORS = 5; // Stop trying after too many consecutive errors
    
    async function loadTVFeed() {
      const container = document.getElementById('tvPlayer');
      try {
        const res = await fetch('https://aesthetic.computer/api/tv?types=tape&limit=20&filter=recent');
        const data = await res.json();
        
        // Get tapes from mixed array or media.tapes
        const tapes = data.mixed || data.media?.tapes || [];
        // Filter for tapes with completed MP4s (most reliable), then any with videoUrl
        tvTapes = tapes.filter(item => 
          item.media?.videoUrl && item.media?.mp4Status === "complete"
        );
        
        // Fallback to any tape with videoUrl if no complete MP4s
        if (!tvTapes.length) {
          tvTapes = tapes.filter(item => item.media?.videoUrl);
        }
        
        if (!tvTapes.length) {
          container.innerHTML = '<div class="tv-no-signal">No signal</div>';
          return;
        }
        
        playTVVideo(0);
      } catch (e) {
        console.error('TV load error:', e);
        container.innerHTML = '<div class="tv-no-signal">No signal</div>';
      }
    }
    
    function playTVVideo(index) {
      const container = document.getElementById('tvPlayer');
      const tape = tvTapes[index];
      if (!tape) {
        container.innerHTML = '<div class="tv-no-signal">No signal</div>';
        return;
      }
      
      container.innerHTML = `
        <video 
          src="${tape.media.videoUrl}" 
          muted 
          playsinline 
          autoplay
          loop="false"
        ></video>
      `;
      
      tvPlayer = container.querySelector('video');
      tvPlayer.addEventListener('ended', () => {
        tvErrorCount = 0; // Reset error count on successful play
        tvIndex = (tvIndex + 1) % tvTapes.length;
        playTVVideo(tvIndex);
      });
      tvPlayer.addEventListener('canplay', () => {
        tvErrorCount = 0; // Reset error count when video loads successfully
      });
      tvPlayer.addEventListener('error', () => {
        tvErrorCount++;
        if (tvErrorCount >= TV_MAX_ERRORS) {
          container.innerHTML = '<div class="tv-no-signal">No signal</div>';
          return;
        }
        // Skip broken videos
        tvIndex = (tvIndex + 1) % tvTapes.length;
        setTimeout(() => playTVVideo(tvIndex), 500);
      });
      tvPlayer.play().catch(() => {
        // Autoplay blocked - add click to play
        container.innerHTML = `
          <div class="tv-loading" style="cursor: pointer;" onclick="this.parentElement.querySelector('video')?.play(); this.remove();">
            ‚ñ∂Ô∏è
          </div>
          <video src="${tape.media.videoUrl}" muted playsinline></video>
        `;
      });
    }
    loadTVFeed();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>justanothersystem.org — Jeffrey Alan Scudder</title>
  <meta name="author" content="Jeffrey Alan Scudder">
  <meta name="description" content="justanothersystem.org — work by Jeffrey Alan Scudder.">
  <link rel="icon" href="https://aesthetic.computer/favicon.ico">

  <!-- Social sharing meta tags -->
  <meta property="og:title" content="justanothersystem.org" />
  <meta property="og:description" content="Work by Jeffrey Alan Scudder." />
  <meta property="og:url" content="https://justanothersystem.org" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="justanothersystem.org" />
  <meta name="twitter:description" content="Work by Jeffrey Alan Scudder." />
  <meta name="twitter:site" content="@whistlegraph" />

  <style>
    @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&display=swap');

    :root {
      --bg: #000;
      --fg: #f0f0f0;
      --dim: #666;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: 'IBM Plex Mono', monospace;
      background: var(--bg);
      color: var(--fg);
    }

    /* Slideshow fills the viewport */
    .slideshow {
      position: fixed;
      inset: 0;
      z-index: 0;
    }

    .slide {
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 1.6s ease-in-out;
      will-change: opacity, transform;
    }

    .slide.active {
      opacity: 1;
    }

    .slide img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Ken Burns animations — 4 variations */
    @keyframes kb-a {
      0%   { transform: scale(1.0) translate(0%, 0%); }
      100% { transform: scale(1.15) translate(2%, 1.5%); }
    }

    @keyframes kb-b {
      0%   { transform: scale(1.15) translate(2%, -1%); }
      100% { transform: scale(1.0) translate(-1%, 1%); }
    }

    @keyframes kb-c {
      0%   { transform: scale(1.0) translate(-1.5%, 1%); }
      100% { transform: scale(1.12) translate(1%, -1.5%); }
    }

    @keyframes kb-d {
      0%   { transform: scale(1.12) translate(1%, 1.5%); }
      100% { transform: scale(1.0) translate(-2%, -1%); }
    }

    .slide.kb-a img { animation: kb-a 8s ease-in-out both; }
    .slide.kb-b img { animation: kb-b 8s ease-in-out both; }
    .slide.kb-c img { animation: kb-c 8s ease-in-out both; }
    .slide.kb-d img { animation: kb-d 8s ease-in-out both; }

    /* Header overlay */
    .overlay {
      position: fixed;
      inset: 0;
      z-index: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      pointer-events: none;
      padding: 1.5rem;
    }

    .overlay a,
    .overlay button {
      pointer-events: auto;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .site-title {
      font-size: 1rem;
      font-weight: 500;
      letter-spacing: -0.01em;
      text-shadow: 0 1px 6px rgba(0,0,0,0.7);
    }

    .site-title a {
      color: var(--fg);
      text-decoration: none;
    }

    .subtitle {
      font-size: 0.85rem;
      color: var(--dim);
      text-shadow: 0 1px 4px rgba(0,0,0,0.7);
    }

    .subtitle a {
      color: var(--dim);
      text-decoration: none;
      border-bottom: 1px solid rgba(255,255,255,0.15);
    }

    .subtitle a:hover {
      color: var(--fg);
    }

    nav {
      display: flex;
      gap: 1rem;
      font-size: 0.8rem;
    }

    nav a {
      color: var(--dim);
      text-decoration: none;
      text-shadow: 0 1px 4px rgba(0,0,0,0.7);
      transition: color 0.2s;
    }

    nav a:hover {
      color: var(--fg);
    }

    /* Bottom bar: counter + progress */
    .bottom-bar {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
    }

    .counter {
      font-size: 0.75rem;
      color: var(--dim);
      text-shadow: 0 1px 4px rgba(0,0,0,0.7);
      font-variant-numeric: tabular-nums;
    }

    .progress-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      height: 2px;
      background: rgba(255,255,255,0.3);
      transition: width linear;
      z-index: 2;
    }
  </style>
</head>
<body>
  <div class="slideshow" id="slideshow"></div>

  <div class="overlay">
    <div class="top-bar">
      <div>
        <h1 class="site-title"><a href="/">justanothersystem.org</a></h1>
        <p class="subtitle"><a href="/bio">Jeffrey Alan Scudder</a></p>
      </div>
      <nav>
        <a href="/bio">Bio</a>
        <a href="/cv">CV</a>
      </nav>
    </div>
    <div class="bottom-bar">
      <span class="counter" id="counter"></span>
    </div>
  </div>

  <div class="progress-bar" id="progressBar"></div>

  <script>
    const ASSET_BASE = '/assets/justanothersystem/slideshow/';
    const MANIFEST_URL = ASSET_BASE + 'manifest.json';
    const SLIDE_DURATION = 6000; // ms per slide
    const KB_CLASSES = ['kb-a', 'kb-b', 'kb-c', 'kb-d'];

    const slideshowEl = document.getElementById('slideshow');
    const counterEl = document.getElementById('counter');
    const progressBar = document.getElementById('progressBar');

    let images = [];
    let currentIndex = 0;
    let slideTimer = null;
    let progressTimer = null;

    // Shuffle array in place (Fisher-Yates)
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    async function init() {
      try {
        const res = await fetch(MANIFEST_URL);
        const data = await res.json();
        images = shuffle([...data.images]);
      } catch (e) {
        console.error('Failed to load manifest:', e);
        return;
      }

      if (images.length === 0) return;

      // Create two slide elements for crossfade
      for (let i = 0; i < 2; i++) {
        const slide = document.createElement('div');
        slide.className = 'slide';
        slide.innerHTML = '<img>';
        slideshowEl.appendChild(slide);
      }

      showSlide(0);
    }

    function showSlide(index) {
      currentIndex = index % images.length;
      const slides = slideshowEl.querySelectorAll('.slide');
      const activeSlot = currentIndex % 2;
      const inactiveSlot = 1 - activeSlot;

      const activeSlide = slides[activeSlot];
      const inactiveSlide = slides[inactiveSlot];

      // Load image into the active slot
      const img = activeSlide.querySelector('img');
      img.src = ASSET_BASE + images[currentIndex];

      // Assign a Ken Burns class
      KB_CLASSES.forEach(c => activeSlide.classList.remove(c));
      activeSlide.classList.add(KB_CLASSES[currentIndex % KB_CLASSES.length]);

      // Crossfade
      activeSlide.classList.add('active');
      inactiveSlide.classList.remove('active');

      // Update counter
      counterEl.textContent = `${currentIndex + 1} / ${images.length}`;

      // Progress bar
      startProgress();

      // Preload next image
      const nextIndex = (currentIndex + 1) % images.length;
      const preload = new Image();
      preload.src = ASSET_BASE + images[nextIndex];

      // Schedule next slide
      clearTimeout(slideTimer);
      slideTimer = setTimeout(() => showSlide(currentIndex + 1), SLIDE_DURATION);
    }

    function startProgress() {
      progressBar.style.transition = 'none';
      progressBar.style.width = '0%';
      // Force reflow
      progressBar.offsetWidth;
      progressBar.style.transition = `width ${SLIDE_DURATION}ms linear`;
      progressBar.style.width = '100%';
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight' || e.key === ' ') {
        e.preventDefault();
        clearTimeout(slideTimer);
        showSlide(currentIndex + 1);
      } else if (e.key === 'ArrowLeft') {
        e.preventDefault();
        clearTimeout(slideTimer);
        showSlide((currentIndex - 1 + images.length) % images.length);
      }
    });

    // Touch swipe navigation
    let touchStartX = 0;
    document.addEventListener('touchstart', (e) => {
      touchStartX = e.touches[0].clientX;
    }, { passive: true });

    document.addEventListener('touchend', (e) => {
      const dx = e.changedTouches[0].clientX - touchStartX;
      if (Math.abs(dx) > 50) {
        clearTimeout(slideTimer);
        if (dx < 0) {
          showSlide(currentIndex + 1);
        } else {
          showSlide((currentIndex - 1 + images.length) % images.length);
        }
      }
    }, { passive: true });

    init();
  </script>
</body>
</html>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>aesthetic.computer</title>
    <script src="/aesthetic.computer/boot.js" type="module" defer></script>
    <!-- Modulepreload hints for critical path modules -->
    <link rel="modulepreload" href="/aesthetic.computer/bios.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/parse.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/disk.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/graph.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/kidlisp.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/num.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/help.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/geo.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/pen.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/keyboard.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/loop.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/store.mjs">
    <link rel="modulepreload" href="/aesthetic.computer/lib/type.mjs">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <link rel="stylesheet" href="/aesthetic.computer/style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="og:title" content="aesthetic.computer" />
    <meta name="og:description" content="Run any piece by typing its name..." />
    <meta name="og:image" content="https://aesthetic.computer/preview/1200x630" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="aesthetic.computer" />
    <meta name="twitter:site" content="aesthetic.computer" />
    <meta name="twitter:image" content="https://aesthetic.computer/preview/800x800"/>
    <script>
      // Global error handler for fatal boot errors
      window.onerror = function(message, source, lineno, colno, error) {
        // Only show if we haven't booted yet (canvas not present)
        if (!document.querySelector('canvas')) {
          const errorDiv = document.createElement('div');
          errorDiv.id = 'boot-error';
          errorDiv.style.cssText = `
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: #111; color: #f88; padding: 2rem;
            font-family: monospace; font-size: 14px; white-space: pre-wrap;
            overflow: auto; z-index: 99999;
          `;
          const sourcePath = source ? source.replace(window.location.origin, '') : 'unknown';
          errorDiv.innerHTML = `<h2 style="color:#ff6666;margin:0 0 1rem 0;">‚ö†Ô∏è Boot Error</h2>` +
            `<strong style="color:#ffcc66;">${message}</strong>\n\n` +
            `File: ${sourcePath}\n` +
            `Line: ${lineno}, Column: ${colno}\n\n` +
            (error?.stack ? `<span style="color:#888;">${error.stack}</span>` : '') +
            `\n\n<span style="color:#666;">Check the browser console (F12) for more details.</span>`;
          document.body.appendChild(errorDiv);
        }
        return false;
      };
      // Also catch unhandled promise rejections
      window.onunhandledrejection = function(event) {
        if (!document.querySelector('canvas')) {
          const errorDiv = document.createElement('div');
          errorDiv.id = 'boot-error';
          errorDiv.style.cssText = `
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: #111; color: #f88; padding: 2rem;
            font-family: monospace; font-size: 14px; white-space: pre-wrap;
            overflow: auto; z-index: 99999;
          `;
          errorDiv.innerHTML = `<h2 style="color:#ff6666;margin:0 0 1rem 0;">‚ö†Ô∏è Boot Error (Promise)</h2>` +
            `<strong style="color:#ffcc66;">${event.reason}</strong>\n\n` +
            (event.reason?.stack ? `<span style="color:#888;">${event.reason.stack}</span>` : '') +
            `\n\n<span style="color:#666;">Check the browser console (F12) for more details.</span>`;
          document.body.appendChild(errorDiv);
        }
      };
    </script>
  </head>
  <body class="native-cursor"> <!-- Hides the 2D UI on first boot. -->
  <!-- Boot Log Overlay - Single Canvas -->
  <canvas id="boot-canvas" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:99999;pointer-events:none;margin:0;padding:0;"></canvas>
  <script>
    // üìº VHS Hacker Boot Screen - syntax highlighted code, variable sizes
    window.acBootCanvas = (function() {
      const canvas = document.getElementById('boot-canvas');
      if (!canvas) return {};
      const ctx = canvas.getContext('2d');
      let W = window.innerWidth, H = window.innerHeight;
      canvas.width = W; canvas.height = H;
      window.addEventListener('resize', () => { W = window.innerWidth; H = window.innerHeight; canvas.width = W; canvas.height = H; });
      const logoSize = 64;
      const logoX = 8, logoY = 8;
      const textX = logoX + logoSize + 14;
      const textStartY = 18;
      const lineHeight = 14;
      const maxLines = 18;
      
      // Inline full purple-pals.svg (minified + URI-encoded) for instant load
      const img = new Image();
      let imgLoaded = false;
      img.onload = () => { imgLoaded = true; };
      img.src = 'data:image/svg+xml;utf8,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%20%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M14.8982%205.10335C15.5333%204.92226%2016.0802%204.97918%2016.6196%205.27392L16.6294%205.27925L16.6386%205.28543C16.8852%205.45034%2017.0637%205.6336%2017.1768%205.8569C17.2893%206.07886%2017.3264%206.31921%2017.3264%206.57986C17.3264%206.8465%2017.3041%207.09444%2017.2269%207.3334C17.2091%207.38846%2017.1886%207.44241%2017.1652%207.4955C17.23%207.47358%2017.2711%207.4571%2017.2859%207.44936C17.3941%207.3926%2017.5907%207.24475%2017.8166%207.06782C17.8604%207.03348%2017.9051%206.99825%2017.9497%206.96304C18.1213%206.82774%2018.2924%206.69283%2018.4123%206.61077C18.6212%206.46789%2018.9896%206.23185%2019.3662%206.01043C19.7366%205.79269%2020.1374%205.57551%2020.4022%205.48361C20.7689%205.35632%2021.2081%205.38009%2021.5334%205.72086C21.7339%205.93084%2021.8023%206.15795%2021.7913%206.36941C21.7808%206.57%2021.7001%206.73725%2021.6399%206.84298L21.6299%206.86056L21.6171%206.87629C21.4157%207.12388%2021.1869%207.28577%2020.956%207.41907C20.851%207.47973%2020.743%207.53584%2020.6386%207.59007L20.6124%207.60369C20.4982%207.66307%2020.3871%207.72144%2020.2759%207.78716C20.0167%207.94039%2019.4561%208.36643%2019.1861%208.59807C18.854%208.88299%2018.5291%209.22697%2018.2969%209.64591C18.2562%209.71926%2018.2357%209.85967%2018.246%2010.0459C18.2558%2010.2216%2018.2902%2010.397%2018.3192%2010.5068C18.3474%2010.6137%2018.369%2010.7073%2018.39%2010.7987C18.4496%2011.0574%2018.5052%2011.2984%2018.696%2011.7739C18.8086%2012.0543%2018.9341%2012.2641%2019.0783%2012.5052C19.1295%2012.5907%2019.183%2012.6802%2019.2391%2012.7781C19.2555%2012.8067%2019.2708%2012.8346%2019.2856%2012.8619C19.3428%2012.9667%2019.3941%2013.0606%2019.4805%2013.1372C19.5653%2013.2123%2019.6973%2013.2788%2019.9584%2013.218L19.9665%2013.2161L19.9748%2013.2147C20.347%2013.1537%2020.6475%2013.0147%2020.955%2012.8725C20.9664%2012.8672%2020.9778%2012.862%2020.9891%2012.8567C21.298%2012.714%2021.636%2012.5602%2022.0258%2012.5602C22.3606%2012.5602%2022.6158%2012.7005%2022.7802%2012.9167C22.9376%2013.1238%2023%2013.384%2023%2013.6229C23%2013.9455%2022.7996%2014.1926%2022.6034%2014.3582C22.4028%2014.5276%2022.1652%2014.6481%2021.9994%2014.718C21.48%2014.9369%2020.4859%2015.2891%2019.7384%2015.3685C19.7042%2015.3721%2019.661%2015.3789%2019.6105%2015.3867C19.1991%2015.4509%2018.3%2015.591%2017.7518%2014.7545C17.6407%2014.585%2017.4006%2014.2594%2017.1498%2013.9515C17.0248%2013.7981%2016.8997%2013.6521%2016.7888%2013.5341C16.6729%2013.4106%2016.5881%2013.3346%2016.5416%2013.305C16.38%2013.2022%2016.262%2013.2217%2016.1713%2013.2721C16.0628%2013.3325%2015.9743%2013.4514%2015.9373%2013.5606C15.8308%2013.8749%2015.691%2014.2874%2015.5776%2014.6879C15.4273%2015.2186%2015.2045%2016.0282%2015.0393%2016.6782C15.0149%2016.7741%2014.9905%2016.8863%2014.963%2017.0127C14.957%2017.0402%2014.9509%2017.0685%2014.9445%2017.0974C14.9098%2017.2562%2014.8705%2017.4305%2014.8234%2017.6033C14.7321%2017.9384%2014.6013%2018.3097%2014.3836%2018.556C14.0202%2018.9669%2013.4846%2019.0727%2013.0429%2018.9548C12.6009%2018.8368%2012.2125%2018.4785%2012.2125%2017.943C12.2125%2017.6301%2012.3162%2017.124%2012.4343%2016.6504C12.5535%2016.1718%2012.6958%2015.6946%2012.7899%2015.416C12.9757%2014.749%2013.2116%2013.8949%2013.3866%2013.1212C13.3979%2013.0613%2013.4099%2012.9976%2013.4226%2012.9309C13.4978%2012.5343%2013.5932%2012.031%2013.6699%2011.5717C13.7149%2011.3024%2013.7529%2011.0514%2013.7766%2010.8478C13.8015%2010.633%2013.8065%2010.5012%2013.7992%2010.4515C13.7844%2010.3497%2013.751%2010.315%2013.729%2010.2987C13.699%2010.2766%2013.6441%2010.2559%2013.5426%2010.2494C13.4417%2010.2429%2013.3238%2010.2517%2013.1852%2010.2649C13.1692%2010.2664%2013.1529%2010.268%2013.1363%2010.2696C13.0172%2010.2811%2012.8839%2010.294%2012.7597%2010.294C12.6223%2010.294%2012.472%2010.2977%2012.3149%2010.3015C11.9756%2010.3098%2011.605%2010.3188%2011.2661%2010.2933C11.1149%2010.2819%2010.9352%2010.258%2010.7544%2010.2337L10.7295%2010.2304C10.5535%2010.2067%2010.3742%2010.1825%2010.2029%2010.1659C10.0225%2010.1485%209.86134%2010.1404%209.7317%2010.1484%209.59167%2010.157%209.53289%2010.1823%209.51826%2010.1932%209.40563%2010.2772%209.36293%2010.3344%209.34618%2010.3683%209.33318%2010.3946%209.32868%2010.4202%209.3367%2010.4673%209.34595%2010.5217%209.36711%2010.5816%209.40163%2010.6792C9.40461%2010.6877%209.40769%2010.6964%209.41087%2010.7054C9.44816%2010.8111%209.49265%2010.9424%209.52178%2011.0999C9.55533%2011.2814%209.5886%2011.4647%209.62198%2011.6487C9.7153%2012.1629%209.80952%2012.6821%209.91334%2013.1798C9.9259%2013.24%209.93878%2013.3014%209.95186%2013.3637C10.1143%2014.1372%2010.3081%2015.0602%2010.3081%2015.8244C10.3081%2015.9889%2010.3121%2016.1554%2010.3162%2016.3235C10.3297%2016.8792%2010.3436%2017.4525%2010.2136%2018.0277C10.0889%2018.5797%209.55124%2018.8059%209.10572%2018.8008C8.66723%2018.7957%208.13248%2018.5567%208.08837%2017.9935C8.06444%2017.6878%208.09368%2017.4281%208.12633%2017.2004C8.13244%2017.1578%208.13853%2017.1171%208.1444%2017.0777C8.17087%2016.9005%208.19298%2016.7524%208.19298%2016.5993C8.19298%2015.8848%208.00978%2015.083%207.83775%2014.4909C7.75439%2014.204%207.63364%2014.1146%207.55668%2014.0888C7.47435%2014.0612%207.35495%2014.0767%707.21784%2014.1711%22%20fill%3D%22%23cd5c9b%22%2F%3E%20%3C%2Fsvg%3E';
      
      // Boot state
      let lines = [];
      let lineCount = 0;
      let bootProgress = 0;
      let cursorVisible = true;
      let cursorTimer = 0;
      let lastLogTime = performance.now();
      let logBurst = 0;
      const bootStartTime = performance.now();
      
      // Syntax highlighting colors (VSCode-ish dark theme)
      const SYN = {
        keyword: [197, 134, 192],    // purple - const, let, function, if, for, return, export, import, async, await, class, new
        function: [220, 220, 170],   // yellow - function names
        string: [206, 145, 120],     // orange - strings
        number: [181, 206, 168],     // green - numbers
        comment: [106, 153, 85],     // dark green - comments
        operator: [212, 212, 212],   // white - operators, punctuation
        type: [78, 201, 176],        // teal - types, classes
        variable: [156, 220, 254],   // light blue - variables
        property: [156, 220, 254],   // light blue - properties
      };
      
      // Tokenized code snippets with syntax info: [text, colorKey]
      const codeTokens = [
        [['const', 'keyword'], [' boot ', 'variable'], ['=', 'operator'], [' async ', 'keyword'], ['() => {', 'operator']],
        [['await', 'keyword'], [' loadSystem', 'function'], ['();', 'operator']],
        [['import', 'keyword'], [' { disk } ', 'variable'], ['from', 'keyword'], [' "./lib"', 'string'], [';', 'operator']],
        [['export', 'keyword'], [' function', 'keyword'], [' paint', 'function'], ['(api) {', 'operator']],
        [['wipe', 'function'], ['(', 'operator'], ['32', 'number'], [', ', 'operator'], ['0', 'number'], [', ', 'operator'], ['64', 'number'], [');', 'operator']],
        [['ink', 'function'], ['(', 'operator'], ['255', 'number'], [', ', 'operator'], ['200', 'number'], [', ', 'operator'], ['100', 'number'], [').', 'operator'], ['box', 'function'], ['();', 'operator']],
        [['if', 'keyword'], [' (event.', 'variable'], ['is', 'function'], ['(', 'operator'], ['"touch"', 'string'], [')) {', 'operator']],
        [['const', 'keyword'], [' [x, y] = api.', 'variable'], ['pen', 'property'], [';', 'operator']],
        [['return', 'keyword'], [' { meta, boot, act };', 'variable']],
        [['async', 'keyword'], [' function', 'keyword'], [' connect', 'function'], ['(ws) {', 'operator']],
        [['socket.', 'variable'], ['send', 'function'], ['(', 'operator'], ['JSON', 'type'], ['.stringify(d));', 'operator']],
        [['class', 'keyword'], [' Aesthetic', 'type'], [' {', 'operator']],
        [['constructor', 'function'], ['(ctx) { ', 'operator'], ['this', 'keyword'], ['.ctx = ctx; }', 'operator']],
        [['render', 'function'], ['() { ', 'operator'], ['this', 'keyword'], ['.draw(); }', 'operator']],
        [['} ', 'operator'], ['// end module', 'comment']],
        [['const', 'keyword'], [' frame = ', 'variable'], ['requestAnimationFrame', 'function'], [';', 'operator']],
        [['ctx.', 'variable'], ['fillStyle', 'property'], [' = ', 'operator'], ['rgb', 'function'], ['(r, g, b);', 'operator']],
        [['gpu.', 'variable'], ['submit', 'function'], ['();', 'operator']],
        [['for', 'keyword'], [' (', 'operator'], ['let', 'keyword'], [' i = ', 'variable'], ['0', 'number'], ['; i < n; i++) {', 'operator']],
        [['pixels[i] = ', 'variable'], ['noise16', 'function'], ['() | ', 'operator'], ['0', 'number'], [';', 'operator']],
        [['buffer.', 'variable'], ['set', 'function'], ['(data);', 'operator']],
        [['export', 'keyword'], [' default', 'keyword'], [' function', 'keyword'], [' sim', 'function'], ['() {', 'operator']],
        [['tick++; ', 'variable'], ['update', 'function'], ['(state);', 'operator']],
        [['signal.', 'variable'], ['dispatch', 'function'], ['(evt);', 'operator']],
        [['function', 'keyword'], [' act', 'function'], ['({ event }) {', 'operator']],
        [['screen.', 'variable'], ['width', 'property'], [', screen.', 'variable'], ['height', 'property']],
        [['const', 'keyword'], [' { pen, keyboard } = $;', 'variable']],
        [['await', 'keyword'], [' fetch', 'function'], ['(', 'operator'], ['"/api/user"', 'string'], [');', 'operator']],
        [['localStorage.', 'variable'], ['setItem', 'function'], ['(k, v);', 'operator']],
        [['new', 'keyword'], [' WebSocket', 'type'], ['(url);', 'operator']],
        [['ctx.', 'variable'], ['beginPath', 'function'], ['();', 'operator']],
        [['ctx.', 'variable'], ['arc', 'function'], ['(x, y, r, ', 'operator'], ['0', 'number'], [', TAU);', 'variable']],
        [['ctx.', 'variable'], ['stroke', 'function'], ['();', 'operator']],
        [['ctx.', 'variable'], ['fill', 'function'], ['();', 'operator']],
        [['Promise', 'type'], ['.all(tasks);', 'operator']],
        [['// async/await pattern', 'comment']],
        [['(() => { ', 'operator'], ['/* IIFE */', 'comment'], [' })();', 'operator']],
      ];
      
      // Multiple code columns - flush left, variable sizes
      let codeColumns = [[], [], [], []]; // 4 columns for full width
      const codeMaxLines = 60;
      const codeScrollSpeed = 2.5; // Faster scroll
      const fontSizes = [9, 10, 11, 12, 13, 14]; // Variable sizes
      
      let frame = 0;
      let running = true;
      
      // Pre-populate columns IMMEDIATELY for instant visual feedback
      const prePopulate = () => {
        for (let col = 0; col < 4; col++) {
          for (let i = 0; i < 25; i++) {
            codeColumns[col].push({
              tokens: codeTokens[Math.random() * codeTokens.length | 0],
              y: H - i * 28 - Math.random() * 20,
              alpha: 0.25 + Math.random() * 0.45,
              speed: codeScrollSpeed + Math.random() * 1.5,
              size: fontSizes[Math.random() * fontSizes.length | 0]
            });
          }
        }
      };
      prePopulate();
      
      const addLine = (msg) => {
        const now = performance.now();
        const deltaMs = now - lastLogTime;
        lastLogTime = now;
        
        const speed = Math.min(1, 500 / Math.max(50, deltaMs));
        logBurst = 0.5 + speed * 0.5;
        
        if (lines.length > 0) lines[0].text = lines[0].text.replace(/_$/, '');
        lines.unshift({ text: msg + '_', time: now, burst: logBurst });
        if (lines.length > maxLines) lines.pop();
        
        lineCount++;
        bootProgress = Math.min(1, lineCount / 15);
      };
      
      const animate = () => {
        if (!running || !document.getElementById('boot-canvas')) return;
        
        const t = frame * 0.05;
        frame++;
        cursorTimer++;
        if (cursorTimer % 15 === 0) cursorVisible = !cursorVisible;
        
        logBurst *= 0.9;
        
        // Chaos INCREASES with boot progress
        const chaos = bootProgress + logBurst * 0.5;
        const colorLerp = bootProgress;
        
        // Base shake from the start
        const baseShake = 0.5 + Math.sin(t * 2) * 0.3;
        const shakeAmount = baseShake + chaos * chaos * 5 + logBurst * 4;
        const shakeX = (Math.random() - 0.5) * shakeAmount;
        const shakeY = (Math.random() - 0.5) * shakeAmount;
        
        // Update streaming code - add multiple lines every frame for density
        const spawnCount = 2 + (chaos * 2) | 0; // More spawns as chaos increases
        for (let s = 0; s < spawnCount; s++) {
          const col = Math.random() * 4 | 0;
          const tokens = codeTokens[Math.random() * codeTokens.length | 0];
          const size = fontSizes[Math.random() * fontSizes.length | 0];
          codeColumns[col].unshift({ 
            tokens: tokens,
            y: H + 5 + Math.random() * 15,
            alpha: 0.25 + Math.random() * 0.5,
            speed: codeScrollSpeed + Math.random() * 1.5,
            size: size
          });
          if (codeColumns[col].length > codeMaxLines) codeColumns[col].pop();
        }
        // Update positions
        codeColumns.forEach(col => {
          col.forEach(c => c.y -= c.speed + chaos * 1.2);
        });
        codeColumns = codeColumns.map(col => col.filter(c => c.y > -20));
        
        // === DRAW ===
        ctx.clearRect(0, 0, W, H);
        
        // Draw streaming code - flush left, spread across full width
        const codeStartX = 6; // Flush left
        const codeWidth = W - 12;
        const colWidth = codeWidth / 4;
        
        codeColumns.forEach((col, colIdx) => {
          const baseX = codeStartX + colIdx * colWidth;
          col.forEach(c => {
            if (c.y < 5 || c.y > H - 5) return;
            const codeAlpha = c.alpha * (0.35 + chaos * 0.4);
            ctx.font = `${c.size}px "Courier New", monospace`;
            
            // Draw each token with syntax color
            let xOffset = 0;
            c.tokens.forEach(([text, colorKey]) => {
              const [r, g, b] = SYN[colorKey] || SYN.operator;
              // Modulate color slightly with chaos
              const cr = Math.min(255, r + chaos * 20) | 0;
              const cg = Math.max(0, g - chaos * 15) | 0;
              const cb = Math.min(255, b + chaos * 10) | 0;
              ctx.fillStyle = `rgb(${cr}, ${cg}, ${cb})`;
              ctx.globalAlpha = codeAlpha;
              
              const codeShake = 0.3 + chaos * 2;
              const tx = baseX + xOffset + (Math.random() - 0.5) * codeShake;
              const ty = c.y + (Math.random() - 0.5) * codeShake;
              ctx.fillText(text, tx, ty);
              xOffset += ctx.measureText(text).width;
            });
          });
        });
        ctx.globalAlpha = 1;
        
        // Draw logo with wobble; use placeholder until SVG finishes loading
        const logoShake = baseShake * 0.8 + chaos * chaos * 3;
        if (imgLoaded || img.complete) {
          ctx.drawImage(img, 
            logoX + shakeX * 0.5 + (Math.random() - 0.5) * logoShake, 
            logoY + shakeY * 0.5 + (Math.random() - 0.5) * logoShake, 
            logoSize, logoSize);
        } else {
          // Quick placeholder circle so users see something instantly
          ctx.save();
          ctx.globalAlpha = 0.95;
          ctx.fillStyle = `rgb(${140 + (Math.random()*80|0)}, ${60 + (Math.random()*40|0)}, ${150 + (Math.random()*80|0)})`;
          ctx.beginPath();
          ctx.arc(logoX + logoSize/2, logoY + logoSize/2, logoSize/2, 0, Math.PI * 2);
          ctx.fill();
          ctx.restore();
        }
        
        // Live ms timer under logo
        const elapsedMs = performance.now() - bootStartTime;
        ctx.font = 'bold 10px "Courier New", monospace';
        const timerStr = (elapsedMs | 0).toString().padStart(5, '0') + 'ms';
        const timerR = 80 + chaos * 120 | 0;
        const timerG = 80 + chaos * 40 | 0;
        const timerB = 100 + chaos * 100 | 0;
        ctx.globalAlpha = 0.6 + chaos * 0.4;
        ctx.fillStyle = `rgb(${timerR}, ${timerG}, ${timerB})`;
        const timerShake = baseShake + chaos * 2;
        ctx.fillText(timerStr, logoX + 4 + shakeX * 0.5 + (Math.random() - 0.5) * timerShake, logoY + logoSize + 14 + shakeY * 0.5 + (Math.random() - 0.5) * timerShake);
        ctx.globalAlpha = 1;
        
        // Draw log text
        ctx.font = '12px "Courier New", monospace';
        const now = performance.now();
        lines.forEach((line, i) => {
          const y = textStartY + i * lineHeight;
          if (y > H - 10) return;
          
          const age = i * 0.08;
          const alpha = Math.max(0.25, 1 - age * 0.6);
          const lineAge = (now - line.time) / 1000;
          const lineBurst = Math.max(0, line.burst - lineAge * 2);
          
          let displayText = line.text;
          if (i === 0 && !cursorVisible) displayText = displayText.replace(/_$/, ' ');
          
          // Shake from start, more with chaos
          const lineShake = baseShake * 0.5 + lineBurst * 3 + chaos * 1.5;
          const lx = textX + shakeX + (Math.random() - 0.5) * lineShake;
          const ly = y + shakeY + (Math.random() - 0.5) * lineShake;
          
          // Colors: pink ‚Üí noise16Aesthetic purple
          const baseR = 200 - colorLerp * 100 - i * 5;
          const baseG = 80 - colorLerp * 55 - i * 4;
          const baseB = 140 + colorLerp * 60 - i * 2;
          
          // Subtle glow from start, stronger with chaos
          ctx.globalAlpha = alpha * (0.15 + chaos * 0.25 + lineBurst * 0.3);
          ctx.filter = `blur(${2 + chaos * 3}px)`;
          ctx.fillStyle = `rgb(${Math.min(255, baseR + 40)}, ${Math.max(0, baseG + 20)}, ${Math.min(255, baseB + 30)})`;
          ctx.fillText(displayText, lx, ly);
          ctx.filter = 'none';
          
          // Main text
          ctx.globalAlpha = alpha;
          ctx.fillStyle = `rgb(${Math.max(0,Math.min(255,baseR + lineBurst * 25))}, ${Math.max(0,baseG)}, ${Math.min(255,baseB + lineBurst * 15)})`;
          ctx.fillText(displayText, lx, ly);
        });
        ctx.globalAlpha = 1;
        
        // === VHS effects - subtle from start, intensify with chaos ===
        
        // Scanlines - always on, subtle
        ctx.globalAlpha = 0.03 + chaos * 0.12;
        ctx.fillStyle = '#000';
        for (let y = 0; y < H; y += 3) ctx.fillRect(0, y, W, 1);
        
        // Occasional glitch from start, more frequent with chaos
        if (Math.random() < 0.05 + chaos * 0.5) {
          const sliceCount = 1 + (chaos * 6) | 0;
          for (let i = 0; i < sliceCount; i++) {
            const gy = Math.random() * H | 0;
            const gh = 2 + Math.random() * 6 | 0;
            const shift = ((Math.random() - 0.5) * (8 + chaos * 25)) | 0;
            if (gy + gh < H && gy > 0) {
              try {
                const slice = ctx.getImageData(0, gy, W, gh);
                ctx.putImageData(slice, shift, gy);
              } catch(e) {}
            }
          }
        }
        
        // VHS noise - light from start
        const noiseAmount = 10 + chaos * 70 | 0;
        ctx.globalAlpha = 0.03 + chaos * 0.1;
        for (let i = 0; i < noiseAmount; i++) {
          ctx.fillStyle = `rgb(${Math.random() * 100 | 0}, ${Math.random() * 40 | 0}, ${Math.random() * 200 | 0})`;
          ctx.fillRect(Math.random() * W | 0, Math.random() * H | 0, 1 + Math.random() * 2, 1);
        }
        
        // Flicker overlay - subtle from start
        ctx.globalAlpha = 0.02 + chaos * 0.12 * (0.5 + Math.random() * 0.5);
        ctx.fillStyle = `rgb(${100 + colorLerp * 20}, ${25 + colorLerp * 10}, ${160 + colorLerp * 40})`;
        ctx.fillRect(0, 0, W, H);
        
        ctx.globalAlpha = 1;
        
        requestAnimationFrame(animate);
      };
      
      // Start animation IMMEDIATELY - don't wait for image
      animate();
      img.onload = () => {}; // Image loads in background
      
      return {
        log: addLine,
        hide: () => { running = false; canvas.remove(); }
      };
    })();
    
    window.acBOOT_LOG_CANVAS = (msg) => {
      if (window.acBootCanvas?.log) window.acBootCanvas.log(msg);
    };
  </script>
  <script>
    if (window.self !== window.top) document.body.classList.add("embed");
    // Apply nogap class immediately if parameter is present to prevent flash
    const params = new URLSearchParams(location.search);
    if (params.has("nogap") || location.search.includes("nogap")) {
      document.body.classList.add("nogap");
    }
  </script>
  </body>
</html>